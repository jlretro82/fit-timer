<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fit Timer</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="timer-container">
    <div class="get-ready" id="getReady">Get Ready</div>
    <div class="circle">
      <div class="countdown" id="countdown">3</div>
      <svg class="progress-ring" width="200" height="200">
        <circle
          class="progress-ring__circle"
          stroke="#4BA3BB"
          stroke-width="10"
          fill="transparent"
          r="90"
          cx="100"
          cy="100"
        />
      </svg>
    </div>
    <div class="controls">
      <button id="startBtn">Start</button>
      <button id="pauseBtn">Pause</button>
      <button id="resetBtn">Reset</button>
    </div>
  </div>

  <script>
    let timer;
    let duration = 30;
    let timeLeft = duration;
    let isPaused = false;
    let countdownEl = document.getElementById('countdown');
    let getReadyEl = document.getElementById('getReady');
    const circle = document.querySelector('.progress-ring__circle');
    const radius = circle.r.baseVal.value;
    const circumference = radius * 2 * Math.PI;
    circle.style.strokeDasharray = circumference;
    circle.style.strokeDashoffset = circumference;

    const tickingSound = new Audio('/ticking.mp3');
    const bellSound = new Audio('/bell.mp3');
    tickingSound.loop = true;

    function setProgress(percent) {
      const offset = circumference - (percent / 100) * circumference;
      circle.style.strokeDashoffset = offset;
    }

    function startCountdown() {
      getReadyEl.style.display = 'block';
      countdownEl.textContent = 3;
      let getReadyTime = 3;

      const getReadyInterval = setInterval(() => {
        if (getReadyTime <= 1) {
          clearInterval(getReadyInterval);
          getReadyEl.style.display = 'none';
          startTimer();
        } else {
          getReadyTime--;
          countdownEl.textContent = getReadyTime;
        }
      }, 1000);
    }

    function startTimer() {
      if (!isPaused) {
        timeLeft = duration;
        setProgress(0);
      }

      isPaused = false;
      tickingSound.currentTime = 0;
      tickingSound.play();

      timer = setInterval(() => {
        if (!isPaused) {
          countdownEl.textContent = timeLeft;
          setProgress(((duration - timeLeft) / duration) * 100);

          if (timeLeft <= 0) {
            clearInterval(timer);
            tickingSound.pause();
            bellSound.play();
            countdownEl.textContent = "Done";
          } else {
            timeLeft--;
          }
        }
      }, 1000);
    }

    document.getElementById('startBtn').addEventListener('click', () => {
      if (!timer || isPaused) {
        startCountdown();
      }
    });

    document.getElementById('pauseBtn').addEventListener('click', () => {
      isPaused = true;
      tickingSound.pause();
    });

    document.getElementById('resetBtn').addEventListener('click', () => {
      clearInterval(timer);
      isPaused = false;
      timeLeft = duration;
      countdownEl.textContent = duration;
      getReadyEl.style.display = 'none';
      setProgress(0);
      tickingSound.pause();
      tickingSound.currentTime = 0;
    });
  </script>
</body>
</html>
